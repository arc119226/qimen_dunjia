/**
 * 奇門遁甲常數定義
 * 
 * 本模組定義了奇門遁甲系統中所有的常數值，包括：
 * - 二十四節氣局數配置（拆補法用）
 * - 九宮索引與方位對應
 * - 飛布軌跡
 * - 天干地支
 * - 九星、八門、八神名稱
 * - 六甲旬首與符首對應
 */

// ============================================================================
// 二十四節氣局數配置（拆補法定局用）
// ============================================================================
/**
 * 節氣局數表
 * 
 * 拆補法原理：
 * - 以節氣交接時刻為嚴格分界
 * - 每個節氣分為上、中、下三元，每元5天
 * - 從節氣交接開始計算天數來判定三元
 * 
 * yang: 是否為陽遁
 * ju: [上元局數, 中元局數, 下元局數]
 */
export const JIEQI_JUSHU = Object.freeze({
    // 陽遁（冬至到芒種）- 陽氣漸生，局數順飛
    '冬至': { yang: true, ju: [1, 7, 4] },
    '小寒': { yang: true, ju: [2, 8, 5] },
    '大寒': { yang: true, ju: [3, 9, 6] },
    '立春': { yang: true, ju: [8, 5, 2] },
    '雨水': { yang: true, ju: [9, 6, 3] },
    '驚蟄': { yang: true, ju: [1, 7, 4] },
    '春分': { yang: true, ju: [3, 9, 6] },
    '清明': { yang: true, ju: [4, 1, 7] },
    '穀雨': { yang: true, ju: [5, 2, 8] },
    '立夏': { yang: true, ju: [4, 1, 7] },
    '小滿': { yang: true, ju: [5, 2, 8] },
    '芒種': { yang: true, ju: [6, 3, 9] },
    // 陰遁（夏至到大雪）- 陰氣漸生，局數逆飛
    '夏至': { yang: false, ju: [9, 3, 6] },
    '小暑': { yang: false, ju: [8, 2, 5] },
    '大暑': { yang: false, ju: [7, 1, 4] },
    '立秋': { yang: false, ju: [2, 5, 8] },
    '處暑': { yang: false, ju: [1, 4, 7] },
    '白露': { yang: false, ju: [9, 3, 6] },
    '秋分': { yang: false, ju: [7, 1, 4] },
    '寒露': { yang: false, ju: [6, 9, 3] },
    '霜降': { yang: false, ju: [5, 8, 2] },
    '立冬': { yang: false, ju: [6, 9, 3] },
    '小雪': { yang: false, ju: [5, 8, 2] },
    '大雪': { yang: false, ju: [4, 7, 1] }
});

/** 三元名稱 */
export const YUAN_NAMES = Object.freeze(['上元', '中元', '下元']);

// ============================================================================
// 九宮索引定義
// ============================================================================
/**
 * 洛書九宮索引
 * 
 * 九宮排列方式（陣列索引對應）：
 *   巽(0)  離(1)  坤(2)
 *   震(3)  中(4)  兌(5)
 *   艮(6)  坎(7)  乾(8)
 * 
 * 此排列對應後天八卦方位：
 *   東南   南    西南
 *   東    中央   西
 *   東北   北    西北
 */
export const PALACE = Object.freeze({
    XUN: 0,    // 巽宮 - 東南
    LI: 1,     // 離宮 - 南
    KUN: 2,    // 坤宮 - 西南
    ZHEN: 3,   // 震宮 - 東
    ZHONG: 4,  // 中宮 - 中央
    DUI: 5,    // 兌宮 - 西
    GEN: 6,    // 艮宮 - 東北
    KAN: 7,    // 坎宮 - 北
    QIAN: 8    // 乾宮 - 西北
});

/**
 * 中宮替代宮位
 * 中宮無門、無方位，當元素落入中宮時，以坤宮(2)代之
 * 此為奇門遁甲傳統規則
 */
export const ZHONG_SUBSTITUTE = PALACE.KUN;

// ============================================================================
// 飛布軌跡定義
// ============================================================================
/**
 * 飛布軌跡說明
 * 
 * 洛書九宮的飛布遵循特定軌跡，非單純的順時針或逆時針
 * 其順序為：坎(7)→坤(2)→震(3)→巽(0)→中(4)→乾(8)→兌(5)→艮(6)→離(1)
 * 
 * 此軌跡源於洛書數字的排列：
 *   4  9  2
 *   3  5  7
 *   8  1  6
 * 
 * 按數字 1→2→3→4→5→6→7→8→9 的順序即為飛布軌跡
 */
export const FLY_PATH = Object.freeze({
    /**
     * 順時針軌跡（不含中宮）
     * 用於：陽局天盤、陽局八門、九星飛布
     * 宮位順序：巽→離→坤→兌→乾→坎→艮→震
     */
    CLOCKWISE: [0, 1, 2, 5, 8, 7, 6, 3],
    
    /**
     * 逆時針軌跡（不含中宮）
     * 用於：陰局八神
     * 宮位順序：巽→震→艮→坎→乾→兌→坤→離
     */
    COUNTER_CLOCKWISE: [0, 3, 6, 7, 8, 5, 2, 1],
    
    /**
     * 八門陽局飛布軌跡（含中宮）
     * 宮位順序：坎→坤→震→巽→中→乾→兌→艮→離
     */
    DOOR_YANG: [7, 2, 3, 0, 4, 8, 5, 6, 1],
    
    /**
     * 八門陰局飛布軌跡（含中宮）
     * 宮位順序：坎→離→艮→兌→乾→中→巽→震→坤
     */
    DOOR_YIN: [7, 1, 6, 5, 8, 4, 0, 3, 2]
});

// ============================================================================
// 方位箭頭（用於視覺化顯示）
// ============================================================================
/**
 * 九宮方位箭頭
 * 用於顯示天禽寄宮等需要方向指示的場合
 */
export const DIRECTION_ARROWS = Object.freeze([
    '↘', '↓', '↙',  // 巽(東南), 離(南), 坤(西南)
    '→', '',  '←',  // 震(東), 中(無), 兌(西)
    '↗', '↑', '↖'   // 艮(東北), 坎(北), 乾(西北)
]);

// ============================================================================
// 先天八卦（河圖）
// ============================================================================
/**
 * 河圖（先天八卦）排列
 * 
 * 圖形排列：
 *   兌  乾  巽
 *   離  中  坎
 *   震  坤  艮
 * 
 * 先天八卦代表宇宙形成前的理想秩序，強調對立配對
 */
export const HETU_BAGUA = Object.freeze([
    '兌', '乾', '巽',
    '離', '中', '坎',
    '震', '坤', '艮'
]);

// ============================================================================
// 後天八卦（洛書）
// ============================================================================
/**
 * 洛書（後天八卦）排列
 * 
 * 圖形排列：
 *   巽  離  坤
 *   震  中  兌
 *   艮  坎  乾
 * 
 * 後天八卦代表萬物形成後的實際運作，對應八方位與四季
 */
export const LUOSHU_BAGUA = Object.freeze([
    '巽', '離', '坤',
    '震', '中', '兌',
    '艮', '坎', '乾'
]);

// ============================================================================
// 飛星九星
// ============================================================================
/**
 * 飛星名稱（一白至九紫）
 * 用於玄空飛星風水系統
 */
export const FLYING_STARS = Object.freeze({
    1: '一白貪狼',
    2: '二黑巨門',
    3: '三碧祿存',
    4: '四綠文昌',
    5: '五黃廉貞',
    6: '六白武曲',
    7: '七赤破軍',
    8: '八白左輔',
    9: '九紫右弼'
});

/**
 * 飛星入中宮後的九宮分布
 * key: 入中宮的星數(1-9)
 * value: 九宮各位置的星數（按洛書九宮順序）
 */
export const FLYING_STAR_CHARTS = Object.freeze({
    1: [2, 6, 4, 3, 1, 8, 7, 5, 9],
    2: [3, 7, 5, 4, 2, 9, 8, 6, 1],
    3: [4, 8, 6, 5, 3, 1, 9, 7, 2],
    4: [5, 9, 7, 6, 4, 2, 1, 8, 3],
    5: [6, 1, 8, 7, 5, 3, 2, 9, 4],
    6: [7, 2, 9, 8, 6, 4, 3, 1, 5],
    7: [8, 3, 1, 9, 7, 5, 4, 2, 6],
    8: [9, 4, 2, 1, 8, 6, 5, 3, 7],
    9: [1, 5, 3, 2, 9, 7, 6, 4, 8]
});

// ============================================================================
// 奇門九星
// ============================================================================
/**
 * 奇門九星本位（按洛書九宮順序）
 * 
 * 九宮分布：
 *   天輔(巽)  天英(離)  天芮(坤)
 *   天沖(震)  天禽(中)  天柱(兌)
 *   天任(艮)  天蓬(坎)  天心(乾)
 */
export const QIMEN_STARS = Object.freeze([
    '天輔', '天英', '天芮',
    '天沖', '天禽', '天柱',
    '天任', '天蓬', '天心'
]);

/**
 * 天禽星索引
 * 天禽居中宮，中宮無門，故需標示其寄託宮位
 */
export const TIANQIN_INDEX = PALACE.ZHONG;

// ============================================================================
// 八門
// ============================================================================
/**
 * 八門本位（按洛書九宮順序）
 * 
 * 九宮分布：
 *   杜門(巽)  景門(離)  死門(坤)
 *   傷門(震)  （無）    驚門(兌)
 *   生門(艮)  休門(坎)  開門(乾)
 * 
 * 中宮無門，故索引4為空字串
 */
export const EIGHT_DOORS_ORIGINAL = Object.freeze([
    '杜門', '景門', '死門',
    '傷門', '',     '驚門',
    '生門', '休門', '開門'
]);

/**
 * 八門飛布順序
 * 從值使門開始，依此順序排列
 */
export const EIGHT_DOORS_SEQUENCE = Object.freeze([
    '休門', '生門', '傷門', '杜門',
    '景門', '死門', '驚門', '開門'
]);

// ============================================================================
// 八神
// ============================================================================
/**
 * 陽局八神
 * 包含：值符、滕蛇、太陰、六合、勾陳、朱雀、九地、九天
 */
export const EIGHT_GODS_YANG = Object.freeze([
    '值符', '滕蛇', '太陰', '六合',
    '勾陳', '朱雀', '九地', '九天'
]);

/**
 * 陰局八神
 * 與陽局差異：勾陳→白虎、朱雀→玄武
 */
export const EIGHT_GODS_YIN = Object.freeze([
    '值符', '滕蛇', '太陰', '六合',
    '白虎', '玄武', '九地', '九天'
]);

// ============================================================================
// 六十甲子與六旬
// ============================================================================
/**
 * 六甲旬首
 * 六十甲子分為六旬，每旬十日，以甲開頭
 */
export const XUN_HEADS = Object.freeze([
    '甲子', '甲戌', '甲申', '甲午', '甲辰', '甲寅'
]);

/**
 * 六旬干支組合
 * 每旬包含十個干支，最後標註該旬的空亡地支
 */
export const SIX_XUNS = Object.freeze({
    '甲子': ['甲子', '乙丑', '丙寅', '丁卯', '戊辰', '己巳', '庚午', '辛未', '壬申', '癸酉'], // 空亡：戌、亥
    '甲戌': ['甲戌', '乙亥', '丙子', '丁丑', '戊寅', '己卯', '庚辰', '辛巳', '壬午', '癸未'], // 空亡：申、酉
    '甲申': ['甲申', '乙酉', '丙戌', '丁亥', '戊子', '己丑', '庚寅', '辛卯', '壬辰', '癸巳'], // 空亡：午、未
    '甲午': ['甲午', '乙未', '丙申', '丁酉', '戊戌', '己亥', '庚子', '辛丑', '壬寅', '癸卯'], // 空亡：辰、巳
    '甲辰': ['甲辰', '乙巳', '丙午', '丁未', '戊申', '己酉', '庚戌', '辛亥', '壬子', '癸丑'], // 空亡：寅、卯
    '甲寅': ['甲寅', '乙卯', '丙辰', '丁巳', '戊午', '己未', '庚申', '辛酉', '壬戌', '癸亥']  // 空亡：子、丑
});

/**
 * 六甲符首對應
 * 甲所遁藏的六儀：甲子遁戊、甲戌遁己、甲申遁庚、甲午遁辛、甲辰遁壬、甲寅遁癸
 */
export const XUN_TO_HEAD = Object.freeze({
    '甲子': '戊',
    '甲戌': '己',
    '甲申': '庚',
    '甲午': '辛',
    '甲辰': '壬',
    '甲寅': '癸'
});

/**
 * 六甲孤虛方位
 * 根據旬首判斷該旬的孤虛方位
 */
export const XUN_TO_KONGWANG_DIRECTION = Object.freeze({
    '甲子': ['西北'],           // 戌亥空亡 → 西北
    '甲戌': ['西南西', '西'],   // 申酉空亡 → 西南西、西
    '甲申': ['南', '南南西'],   // 午未空亡 → 南、南南西
    '甲午': ['東南'],           // 辰巳空亡 → 東南
    '甲辰': ['東北東', '東'],   // 寅卯空亡 → 東北東、東
    '甲寅': ['北', '北北東']    // 子丑空亡 → 北、北北東
});

// ============================================================================
// 地盤三奇六儀
// ============================================================================
/**
 * 三奇六儀說明
 * 
 * 三奇：乙（日奇）、丙（月奇）、丁（星奇）
 * 六儀：戊、己、庚、辛、壬、癸
 * 
 * 甲為十干之首，象徵主帥，遁入六儀之下而不顯現
 * 故地盤僅見乙丙丁戊己庚辛壬癸九干
 */

/**
 * 陽局地盤配置
 * key: 局數(1-9)
 * value: 九宮各位置的天干（按洛書九宮順序）
 */
export const DIPAN_YANG = Object.freeze({
    1: ['辛', '乙', '己', '庚', '壬', '丁', '丙', '戊', '癸'],
    2: ['庚', '丙', '戊', '己', '辛', '癸', '丁', '乙', '壬'],
    3: ['己', '丁', '乙', '戊', '庚', '壬', '癸', '丙', '辛'],
    4: ['戊', '癸', '丙', '乙', '己', '辛', '壬', '丁', '庚'],
    5: ['乙', '壬', '丁', '丙', '戊', '庚', '辛', '癸', '己'],
    6: ['丙', '辛', '癸', '丁', '乙', '己', '庚', '壬', '戊'],
    7: ['丁', '庚', '壬', '癸', '丙', '戊', '己', '辛', '乙'],
    8: ['癸', '己', '辛', '壬', '丁', '乙', '戊', '庚', '丙'],
    9: ['壬', '戊', '庚', '辛', '癸', '丙', '乙', '己', '丁']
});

/**
 * 陰局地盤配置
 * key: 局數(1-9)
 * value: 九宮各位置的天干（按洛書九宮順序）
 */
export const DIPAN_YIN = Object.freeze({
    1: ['丁', '己', '乙', '丙', '癸', '辛', '庚', '戊', '壬'],
    2: ['丙', '庚', '戊', '乙', '丁', '壬', '辛', '己', '癸'],
    3: ['乙', '辛', '己', '戊', '丙', '癸', '壬', '庚', '丁'],
    4: ['戊', '壬', '庚', '己', '乙', '丁', '癸', '辛', '丙'],
    5: ['己', '癸', '辛', '庚', '戊', '丙', '丁', '壬', '乙'],
    6: ['庚', '丁', '壬', '辛', '己', '乙', '丙', '癸', '戊'],
    7: ['辛', '丙', '癸', '壬', '庚', '戊', '乙', '丁', '己'],
    8: ['壬', '乙', '丁', '癸', '辛', '己', '戊', '丙', '庚'],
    9: ['癸', '戊', '丙', '丁', '壬', '庚', '己', '乙', '辛']
});

export default {
    PALACE,
    ZHONG_SUBSTITUTE,
    FLY_PATH,
    DIRECTION_ARROWS,
    HETU_BAGUA,
    LUOSHU_BAGUA,
    FLYING_STARS,
    FLYING_STAR_CHARTS,
    QIMEN_STARS,
    TIANQIN_INDEX,
    EIGHT_DOORS_ORIGINAL,
    EIGHT_DOORS_SEQUENCE,
    EIGHT_GODS_YANG,
    EIGHT_GODS_YIN,
    XUN_HEADS,
    SIX_XUNS,
    XUN_TO_HEAD,
    XUN_TO_KONGWANG_DIRECTION,
    DIPAN_YANG,
    DIPAN_YIN
};
